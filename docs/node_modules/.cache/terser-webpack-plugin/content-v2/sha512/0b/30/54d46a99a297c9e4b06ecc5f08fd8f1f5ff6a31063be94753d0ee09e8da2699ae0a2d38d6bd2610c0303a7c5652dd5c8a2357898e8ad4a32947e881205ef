{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[443],{842:function(e,t,a){\"use strict\";a.r(t);var o=a(56),r=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":e.$parent.slotKey}},[a(\"h1\",{attrs:{id:\"module-2\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#module-2\"}},[e._v(\"#\")]),e._v(\" Module 2\")]),e._v(\" \"),a(\"h2\",{attrs:{id:\"red-hat-quay-private-container-registry\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#red-hat-quay-private-container-registry\"}},[e._v(\"#\")]),e._v(\" Red Hat Quay private container registry\")]),e._v(\" \"),a(\"p\",[e._v(\"You can use Quay.io to automate your container builds, with integration to GitHub, Bitbucket, and more. Robot accounts allow you to lock down automated access and audit each deployment. In these examples, we will use a Quay.io cloud account to store our images which we will build, scan and push to the registry using the CLI.\")]),e._v(\" \"),a(\"h3\",{attrs:{id:\"scanning-container-images-for-vulnerabilities\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#scanning-container-images-for-vulnerabilities\"}},[e._v(\"#\")]),e._v(\" Scanning container images for vulnerabilities\")]),e._v(\" \"),a(\"p\",[e._v(\"First, we will \"),a(\"a\",{attrs:{href:\"https://docs.docker.com/engine/reference/commandline/login/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"code\",[e._v(\"docker login\")]),a(\"OutboundLink\")],1),e._v(\" into our Quay registry. If you are new to Quay, it is recommended that you complete the \"),a(\"a\",{attrs:{href:\"https://quay.io/tutorial/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"tutorial\"),a(\"OutboundLink\")],1),e._v(\" where you will learn how to generate an encrypted password to use with the Docker CLI.\")]),e._v(\" \"),a(\"p\",[e._v('{% hint style=\"info\" %}\\nThe Docker CLI stores passwords entered on the command line in '),a(\"strong\",[e._v(\"plaintext\")]),e._v(\". It is therefore highly recommended to generate an an encrypted version of your password to use for \"),a(\"code\",[e._v(\"docker login\")]),e._v(\".\\n{% endhint %}\")]),e._v(\" \"),a(\"p\",[e._v(\"Run the command below, substituting \"),a(\"code\",[e._v(\"<QUAY_USER>\")]),e._v(\" with your unique Quay.io username and \"),a(\"code\",[e._v(\"<GUID>\")]),e._v(\" with your encrypted password.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"docker\")]),e._v(\" login -u\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[e._v('\"<QUAY_USER>\"')]),e._v(\" -p\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[e._v('\"<GUID>\"')]),e._v(\" quay.io\\n\")])])]),a(\"p\",[e._v(\"Next, from your terminal, navigate to the directory of the \"),a(\"code\",[e._v(\"goof\")]),e._v(\" repo you previously cloned. At the root of this directory you will see a \"),a(\"a\",{attrs:{href:\"https://github.com/snyk/goof/blob/master/Dockerfile\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"code\",[e._v(\"Dockerfile\")]),a(\"OutboundLink\")],1),e._v(\". We will build and tag an image from this Dockerfile using the \"),a(\"a\",{attrs:{href:\"https://docs.docker.com/engine/reference/commandline/build/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"code\",[e._v(\"docker build\")]),a(\"OutboundLink\")],1),e._v(\" command as show below. Again, replace \"),a(\"code\",[e._v(\"<QUAY_USER>\")]),e._v(\" with your username.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"docker\")]),e._v(\" build -t \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"<\")]),e._v(\"QUAY_USER\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\">\")]),e._v(\"/goof \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[e._v(\".\")]),e._v(\"\\n\")])])]),a(\"p\",[e._v(\"At this point, you would normally push your image to a registry. However, we will perform one additional and critical step before we do so. We will scan our container image using Snyk to identify vulnerabilities and provide base image recommendations. To do this, we will run the following command in our terminal:\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[e._v(\"snyk monitor --docker quay.io/\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"<\")]),e._v(\"QUAY_USER\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\">\")]),e._v(\"/goof \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\"\\\\\")]),e._v(\"\\n--file\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"=\")]),e._v(\"submodules/goof/Dockerfile --org\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"<\")]),e._v(\"SNYK_ORG\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\">\")]),e._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\"\\\\\")]),e._v(\"\\n--project-name\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"=\")]),e._v(\"quay-cli-container-image\\n\")])])]),a(\"p\",[e._v(\"Let's take a moment and break down what we are doing in the above command. The \"),a(\"code\",[e._v(\"monitor\")]),e._v(\" command will record the state of dependencies and any vulnerabilities to your account on \"),a(\"a\",{attrs:{href:\"https://snyk.io\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"snyk.io\"),a(\"OutboundLink\")],1),e._v(\" so you can later review those results.\")]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://partner-workshop-assets.s3.us-east-2.amazonaws.com/quay-cli-container-scan.gif\",alt:\"\"}})]),e._v(\" \"),a(\"p\",[e._v(\"Once complete, we are ready to push the image to our Quay registry and will do so by invoking the \"),a(\"a\",{attrs:{href:\"https://docs.docker.com/engine/reference/commandline/push/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"code\",[e._v(\"docker push\")]),a(\"OutboundLink\")],1),e._v(\" command as show below:\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"docker\")]),e._v(\" push quay.io/\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"<\")]),e._v(\"QUAY_USER\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\">\")]),e._v(\"/goof\\n\")])])]),a(\"p\",[e._v(\"Upon successful completion you should see results similar to the following:\")]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://partner-workshop-assets.s3.us-east-2.amazonaws.com/docker-push.gif\",alt:\"\"}})]),e._v(\" \"),a(\"p\",[e._v(\"We can optionally verify our image was indeed successfully pushed by logging into Quay.io and confirming the appropriate image has been tagged.\")]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://partner-workshop-assets.s3.us-east-2.amazonaws.com/rh-quay.png\",alt:\"\"}})]),e._v(\" \"),a(\"p\",[e._v(\"When we ran \"),a(\"code\",[e._v(\"snyk monitor\")]),e._v(\" against our Dockerfile, we passed two parameters: \"),a(\"code\",[e._v(\"--org\")]),e._v(\" and \"),a(\"code\",[e._v(\"--project-name\")]),e._v(\". This action allowed the results from our CLI to be saved to our Snyk account. A report of the findings is now available by logging into your Snyk account and viewing the imported projects.\")]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://partner-workshop-assets.s3.us-east-2.amazonaws.com/container-image-scan-results.png\",alt:\"\"}})]),e._v(\" \"),a(\"p\",[e._v(\"To receive base image remediation advice, including major, minor and alternative upgrades as well as advice when you need to rebuild your image, integrate with your preferred Git repository and import the repo that contains the relevant Dockerfile. You also need to \"),a(\"a\",{attrs:{href:\"https://support.snyk.io/hc/en-us/articles/360003916218-Adding-your-Dockerfile-and-test-your-base-image\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"add the Dockerfile to the image\"),a(\"OutboundLink\")],1),e._v(\".\")]),e._v(\" \"),a(\"p\",[e._v(\"Once complete, you will see \"),a(\"strong\",[e._v(\"recommendations for base image upgrade\")]),e._v(\".\")]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://partner-workshop-assets.s3.us-east-2.amazonaws.com/base-image-recommend.png\",alt:\"\"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);","extractedComments":[]}
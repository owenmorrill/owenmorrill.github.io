{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[821],{1220:function(t,e,a){\"use strict\";a.r(e);var s=a(56),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[a(\"h1\",{attrs:{id:\"clone-and-run-the-sample-application\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#clone-and-run-the-sample-application\"}},[t._v(\"#\")]),t._v(\" Clone and run the sample application\")]),t._v(\" \"),a(\"h2\",{attrs:{id:\"step-1-get-the-sample-app-and-clone-the-repo\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#step-1-get-the-sample-app-and-clone-the-repo\"}},[t._v(\"#\")]),t._v(\" Step 1: Get the sample app and clone the Repo\")]),t._v(\" \"),a(\"p\",[t._v(\"A template GitHub Repo is provided for this workshop using \"),a(\"a\",{attrs:{href:\"https://github.com/snyk/goof#goof---snyks-vulnerable-demo-app\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Snyk's Goof application\"),a(\"OutboundLink\")],1),t._v(\".\")]),t._v(\" \"),a(\"p\",[t._v('{% embed url=\"https://github.com/snyk-partners/docker-academy\" caption=\"\" %}')]),t._v(\" \"),a(\"p\",[t._v('Click \"Use this Template\" to copy the Repo into your GitHub account.')]),t._v(\" \"),a(\"p\",[t._v('{% hint style=\"danger\" %}\\nTo properly copy-paste the commands in these instructions name your repo '),a(\"code\",[t._v(\"docker-academy\")]),t._v(\". Otherwise, ensure the command uses the correct repo name.\\n{% endhint %}\")]),t._v(\" \"),a(\"p\",[t._v(\"If you want to copy-paste commands, set an environment variable for your GitHub ID.\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# Set an environment variable for your GitHub ID\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[t._v(\"GithubId\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<<\")]),t._v(\"your_github_id\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">>\")]),t._v(\"\\n\")])])]),a(\"p\",[t._v(\"Now, clone the Repo to your local environment, then \"),a(\"code\",[t._v(\"cd\")]),t._v(\" into it.\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# Clone the Repo and cd \")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"git\")]),t._v(\" clone https://www.github.com/\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$GithubId\")]),t._v(\"/docker-academy \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"&&\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[t._v(\"cd\")]),t._v(\" docker-academy\\n\")])])]),a(\"h2\",{attrs:{id:\"step-2-test-the-application-locally\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#step-2-test-the-application-locally\"}},[t._v(\"#\")]),t._v(\" Step 2: Test the Application locally\")]),t._v(\" \"),a(\"h3\",{attrs:{id:\"install-dependencies\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#install-dependencies\"}},[t._v(\"#\")]),t._v(\" Install Dependencies\")]),t._v(\" \"),a(\"p\",[t._v(\"To run our application locally, we need to install its dependencies first.\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# Install npm dependencies and generate lockfile\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"npm\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"install\")]),t._v(\" --package-lock\\n\")])])]),a(\"h3\",{attrs:{id:\"start-the-mongo-database\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#start-the-mongo-database\"}},[t._v(\"#\")]),t._v(\" Start the Mongo database\")]),t._v(\" \"),a(\"p\",[t._v(\"The app requires MongoDB to work. Instead of installing Mongo, we'll run it in a Docker container.\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# Start detached mongo with container port 27017 mapped to host port 27017\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"docker\")]),t._v(\" run -d -p \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"27017\")]),t._v(\":27017 mongo\\n\")])])]),a(\"p\",[t._v(\"You can verify that mongo is running by running \"),a(\"code\",[t._v(\"docker ps\")]),t._v(\".\")]),t._v(\" \"),a(\"h3\",{attrs:{id:\"start-the-application\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#start-the-application\"}},[t._v(\"#\")]),t._v(\" Start the Application\")]),t._v(\" \"),a(\"p\",[t._v(\"Now you can run the application.\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"node\")]),t._v(\" app.js\\n\")])])]),a(\"p\",[t._v(\"Once it starts, it will be available at \"),a(\"a\",{attrs:{href:\"http://localhost:3001\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"http://localhost:3001\"),a(\"OutboundLink\")],1),t._v(\". Verify it works by adding a few items into the todo list.\")]),t._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://partner-workshop-assets.s3.us-east-2.amazonaws.com/todo.png\",alt:\"\"}})]),t._v(\" \"),a(\"p\",[t._v(\"Success! Now that we know it works, let's package it in a container for distribution.\")]),t._v(\" \"),a(\"h2\",{attrs:{id:\"build-the-docker-image\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#build-the-docker-image\"}},[t._v(\"#\")]),t._v(\" Build the Docker Image\")]),t._v(\" \"),a(\"p\",[t._v(\"If you want to copy-paste commands, set an environment variable for your Docker ID.\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# Set an environment variable for your GitHub ID\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[t._v(\"DockerId\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<<\")]),t._v(\"your_docker_id\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">>\")]),t._v(\"\\n\")])])]),a(\"p\",[t._v(\"The \"),a(\"code\",[t._v(\"Dockerfile\")]),t._v(\" in the repo tells \"),a(\"code\",[t._v(\"docker build\")]),t._v(\" how to build the container. To learn more about Dockerfile commands, visit \"),a(\"a\",{attrs:{href:\"https://docs.docker.com/engine/reference/builder/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Docker's documentation\"),a(\"OutboundLink\")],1),t._v(\". A summary is provided below:\")]),t._v(\" \"),a(\"p\",[t._v('{% code title=\"Dockerfile\" %}')]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[t._v(\"FROM node:10.4 \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"## Use Node 10.4 as our base image\")]),t._v(\"\\n\\nRUN \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"mkdir\")]),t._v(\" /usr/src/goof \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"## Create the directory for our application\")]),t._v(\"\\nRUN \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"mkdir\")]),t._v(\" /tmp/extracted_files\\nCOPY \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[t._v(\".\")]),t._v(\" /usr/src/goof \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"## Copy the current directory files into the image\")]),t._v(\"\\nWORKDIR /usr/src/goof \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"## Set the working directory\")]),t._v(\"\\n\\nRUN \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"npm\")]),t._v(\" update \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"## Ensure npm is up to date\")]),t._v(\"\\nRUN \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"npm\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"install\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"## Install dependencies\")]),t._v(\"\\nEXPOSE \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"3001\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"## Expose the port\")]),t._v(\"\\nEXPOSE \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"9229\")]),t._v(\"\\nENTRYPOINT \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"npm\"')]),t._v(\", \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"start\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"## The command\")]),t._v(\"\\n\")])])]),a(\"p\",[t._v(\"{% endcode %}\")]),t._v(\" \"),a(\"p\",[t._v(\"When ready, build and tag the container image to get it ready to push into Docker Hub.\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# Build the container and tag it dev\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"docker\")]),t._v(\" build -t \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$DockerId\")]),t._v(\"/goof:dev \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[t._v(\".\")]),t._v(\"\\n\")])])]),a(\"p\",[t._v(\"When the build finishes, push the container to Docker Hub.\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# Push to Docker Hub\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"docker\")]),t._v(\" push \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$DockerId\")]),t._v(\"/goof:dev\\n\")])])]),a(\"h2\",{attrs:{id:\"deploy-the-application-to-kubernetes\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#deploy-the-application-to-kubernetes\"}},[t._v(\"#\")]),t._v(\" Deploy the application to Kubernetes\")]),t._v(\" \"),a(\"p\",[t._v(\"To ensure the container deploys correctly into Kubernetes without incurring cloud costs, we use the Kubernetes cluster shipped with Docker Desktop. Before deploying the app, you'll need to make a change to the app's deployment manifest. Open the file \"),a(\"code\",[t._v(\"goof-deployment.yaml\")]),t._v(\" in a text editor.\")]),t._v(\" \"),a(\"p\",[t._v(\"Find these lines, and insert your Docker ID where indicated.\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-yaml extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"spec\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"containers\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"image\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" <<DOCKERID\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")]),t._v(\"/goof\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"dev \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"#Edit with your Docker Hub ID\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"name\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" goof\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"imagePullPolicy\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" Always\\n\")])])]),a(\"p\",[t._v(\"Save your changes. Now you're ready to deploy the application. Run the following commands:\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# Create a namespace\")]),t._v(\"\\nkubectl create ns snyk-docker\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# Set the current context to use the new namespace\")]),t._v(\"\\nkubectl config set-context --current --namespace snyk-docker\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# Spin up the goof deployment and service\")]),t._v(\"\\nkubectl create -f goof-deployment.yaml,goof-mongo-deployment.yaml\\n\")])])]),a(\"p\",[t._v(\"To check the status of the pods as the application comes up, use the following command:\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[t._v(\"kubectl get pods\\n\")])])]),a(\"p\",[t._v(\"Once both are running, the application should now be accessible in \"),a(\"a\",{attrs:{href:\"http://localhost:3001\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"http://localhost:3001\"),a(\"OutboundLink\")],1),t._v(\". Success!\")]),t._v(\" \"),a(\"p\",[t._v(\"Now that we know our application works when deployed into Kubernetes, we'll set up a continuous integration and continuous delivery pipeline to re-build our container as code changes are made.\")])])}),[],!1,null,null,null);e.default=n.exports}}]);","extractedComments":[]}
{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[356],{754:function(t,e,a){\"use strict\";a.r(e);var s=a(56),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[a(\"h1\",{attrs:{id:\"deploy-the-application\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#deploy-the-application\"}},[t._v(\"#\")]),t._v(\" Deploy the application\")]),t._v(\" \"),a(\"p\",[t._v(\"Now, we are ready to push our application. Here we are calling the \"),a(\"code\",[t._v(\"aws-eks/python3\")]),t._v(\" \"),a(\"a\",{attrs:{href:\"https://circleci.com/docs/2.0/configuration-reference/#executors-requires-version-21\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"executor\"),a(\"OutboundLink\")],1),t._v(\" which will define the environment in which the steps of our job will be run.\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-yaml extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[a(\"code\",[t._v(\"  \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"deploy_app\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"executor\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" aws\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\"eks/python3\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"parameters\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"cluster-name\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"type\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" string\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"docker-image-name\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"type\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" string\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"version-info\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"type\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" string\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"aws-region\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"type\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" string\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"default\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"\"')]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"steps\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" checkout\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"run\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"name\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" Create deployment manifest\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"command\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"|\")]),a(\"span\",{pre:!0,attrs:{class:\"token scalar string\"}},[t._v(\"\\n            BUILD_DATE=$(date '+%Y%m%d%H%M%S')\\n            cat deployment/goof-deployment-template.yaml |\\\\\\n               sed \\\"s|DOCKER_IMAGE_NAME|<< parameters.docker-image-name >>|g\\\"\\\\\\n                 > deployment/goof-deployment.yaml\")]),t._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"aws-eks/update-kubeconfig-with-authenticator\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"cluster-name\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" << parameters.cluster\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\"name \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")]),t._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"install-kubectl\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token boolean important\"}},[t._v(\"true\")]),t._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"aws-region\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" << parameters.aws\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\"region \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")]),t._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"kubernetes/create-or-update-resource\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"resource-file-path\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"deployment/goof-deployment.yaml\"')]),t._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"get-rollout-status\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token boolean important\"}},[t._v(\"true\")]),t._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"resource-name\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" deployment/goof\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"kubernetes/create-or-update-resource\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"resource-file-path\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"deployment/goof-service.yaml\"')]),t._v(\"\\n\")])])]),a(\"p\",[t._v(\"In this job, we are passing a few \"),a(\"a\",{attrs:{href:\"https://circleci.com/docs/2.0/configuration-reference/#parameters-requires-version-21\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"parameters\"),a(\"OutboundLink\")],1),t._v(\" such as the Kubernetes \"),a(\"code\",[t._v(\"cluster-name\")]),t._v(\" and the \"),a(\"code\",[t._v(\"docker-image-name\")]),t._v(\" which references the image we recently created. We are using these values to authenticate to our Kubernetes cluster and also to replace the value of our image in our Kubernetes manifest with the \"),a(\"a\",{attrs:{href:\"https://docs.aws.amazon.com/AmazonECR/latest/userguide/docker-pull-ecr-image.html\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Amazon ECR repository URL\"),a(\"OutboundLink\")],1),t._v(\" and tag. Then, will invoke the \"),a(\"code\",[t._v(\"kubernetes/create-or-update-resources\")]),t._v(\" command to apply our Kubernetes manifests for the deployment and service.\")])])}),[],!1,null,null,null);e.default=n.exports}}]);","extractedComments":[]}
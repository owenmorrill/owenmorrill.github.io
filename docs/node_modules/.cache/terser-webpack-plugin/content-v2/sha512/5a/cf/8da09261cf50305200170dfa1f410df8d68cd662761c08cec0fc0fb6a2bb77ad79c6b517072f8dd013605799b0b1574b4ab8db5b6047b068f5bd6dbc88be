{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[372],{768:function(e,t,a){\"use strict\";a.r(t);var s=a(56),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":e.$parent.slotKey}},[a(\"h1\",{attrs:{id:\"clone-and-run-the-sample-application\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#clone-and-run-the-sample-application\"}},[e._v(\"#\")]),e._v(\" Clone and run the sample application\")]),e._v(\" \"),a(\"h2\",{attrs:{id:\"step-1-get-the-sample-app-and-clone-the-repo\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#step-1-get-the-sample-app-and-clone-the-repo\"}},[e._v(\"#\")]),e._v(\" Step 1: Get the sample app and clone the Repo\")]),e._v(\" \"),a(\"p\",[e._v(\"A template GitHub Repo is provided for this workshop using \"),a(\"a\",{attrs:{href:\"https://github.com/snyk/goof#goof---snyks-vulnerable-demo-app\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Snyk's Goof application\"),a(\"OutboundLink\")],1),e._v(\".\")]),e._v(\" \"),a(\"p\",[e._v('{% embed url=\"https://github.com/snyk-partners/docker-academy\" caption=\"\" %}')]),e._v(\" \"),a(\"p\",[e._v('Click \"Use this Template\" to copy the Repo into your GitHub account.')]),e._v(\" \"),a(\"p\",[e._v('{% hint style=\"danger\" %}\\nTo properly copy-paste the commands in these instructions name your repo '),a(\"code\",[e._v(\"docker-academy\")]),e._v(\". Otherwise, ensure the command uses the correct repo name.\\n{% endhint %}\")]),e._v(\" \"),a(\"p\",[e._v(\"If you want to copy-paste commands, set an environment variable for your GitHub ID.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"# Set an environment variable for your GitHub ID\")]),e._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[e._v(\"GithubId\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"<<\")]),e._v(\"your_github_id\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\">>\")]),e._v(\"\\n\")])])]),a(\"p\",[e._v(\"Now, clone the Repo to your local environment, then \"),a(\"code\",[e._v(\"cd\")]),e._v(\" into it.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"# Clone the Repo and cd \")]),e._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"git\")]),e._v(\" clone https://www.github.com/\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[e._v(\"$GithubId\")]),e._v(\"/docker-academy \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"&&\")]),e._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[e._v(\"cd\")]),e._v(\" docker-academy\\n\")])])]),a(\"h2\",{attrs:{id:\"step-2-test-the-application-locally\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#step-2-test-the-application-locally\"}},[e._v(\"#\")]),e._v(\" Step 2: Test the Application locally\")]),e._v(\" \"),a(\"h3\",{attrs:{id:\"install-dependencies\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#install-dependencies\"}},[e._v(\"#\")]),e._v(\" Install Dependencies\")]),e._v(\" \"),a(\"p\",[e._v(\"To run our application locally, we need to install its dependencies first.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"# Install npm dependencies and generate lockfile\")]),e._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"npm\")]),e._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"install\")]),e._v(\" --package-lock\\n\")])])]),a(\"h3\",{attrs:{id:\"start-the-mongo-database\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#start-the-mongo-database\"}},[e._v(\"#\")]),e._v(\" Start the Mongo database\")]),e._v(\" \"),a(\"p\",[e._v(\"The app requires MongoDB to work. Instead of installing Mongo, we'll run it in a Docker container.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"# Start detached mongo with container port 27017 mapped to host port 27017\")]),e._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"docker\")]),e._v(\" run -d -p \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[e._v(\"27017\")]),e._v(\":27017 mongo\\n\")])])]),a(\"p\",[e._v(\"You can verify that mongo is running by running \"),a(\"code\",[e._v(\"docker ps\")]),e._v(\".\")]),e._v(\" \"),a(\"h3\",{attrs:{id:\"start-the-application\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#start-the-application\"}},[e._v(\"#\")]),e._v(\" Start the Application\")]),e._v(\" \"),a(\"p\",[e._v(\"Now you can run the application.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"node\")]),e._v(\" app.js\\n\")])])]),a(\"p\",[e._v(\"Once it starts, it will be available at \"),a(\"a\",{attrs:{href:\"http://localhost:3001\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"http://localhost:3001\"),a(\"OutboundLink\")],1),e._v(\". Verify it works by adding a few items into the todo list.\")]),e._v(\" \"),a(\"p\",[e._v(\"(IMAGE REMOVED!) - (https://partner-workshop-assets.s3.us-east-2.amazonaws.com/todo.png)\")]),e._v(\" \"),a(\"p\",[e._v(\"Success! Now that we know it works, let's package it in a container for distribution.\")]),e._v(\" \"),a(\"h2\",{attrs:{id:\"build-the-docker-image\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#build-the-docker-image\"}},[e._v(\"#\")]),e._v(\" Build the Docker Image\")]),e._v(\" \"),a(\"p\",[e._v(\"If you want to copy-paste commands, set an environment variable for your Docker ID.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"# Set an environment variable for your GitHub ID\")]),e._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[e._v(\"DockerId\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"<<\")]),e._v(\"your_docker_id\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\">>\")]),e._v(\"\\n\")])])]),a(\"p\",[e._v(\"The \"),a(\"code\",[e._v(\"Dockerfile\")]),e._v(\" in the repo tells \"),a(\"code\",[e._v(\"docker build\")]),e._v(\" how to build the container. To learn more about Dockerfile commands, visit \"),a(\"a\",{attrs:{href:\"https://docs.docker.com/engine/reference/builder/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Docker's documentation\"),a(\"OutboundLink\")],1),e._v(\". A summary is provided below:\")]),e._v(\" \"),a(\"p\",[e._v('{% code title=\"Dockerfile\" %}')]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[e._v(\"FROM node:10.4 \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"## Use Node 10.4 as our base image\")]),e._v(\"\\n\\nRUN \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"mkdir\")]),e._v(\" /usr/src/goof \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"## Create the directory for our application\")]),e._v(\"\\nRUN \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"mkdir\")]),e._v(\" /tmp/extracted_files\\nCOPY \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[e._v(\".\")]),e._v(\" /usr/src/goof \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"## Copy the current directory files into the image\")]),e._v(\"\\nWORKDIR /usr/src/goof \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"## Set the working directory\")]),e._v(\"\\n\\nRUN \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"npm\")]),e._v(\" update \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"## Ensure npm is up to date\")]),e._v(\"\\nRUN \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"npm\")]),e._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"install\")]),e._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"## Install dependencies\")]),e._v(\"\\nEXPOSE \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[e._v(\"3001\")]),e._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"## Expose the port\")]),e._v(\"\\nEXPOSE \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[e._v(\"9229\")]),e._v(\"\\nENTRYPOINT \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[e._v('\"npm\"')]),e._v(\", \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[e._v('\"start\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\"]\")]),e._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"## The command\")]),e._v(\"\\n\")])])]),a(\"p\",[e._v(\"{% endcode %}\")]),e._v(\" \"),a(\"p\",[e._v(\"When ready, build and tag the container image to get it ready to push into Docker Hub.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"# Build the container and tag it dev\")]),e._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"docker\")]),e._v(\" build -t \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[e._v(\"$DockerId\")]),e._v(\"/goof:dev \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[e._v(\".\")]),e._v(\"\\n\")])])]),a(\"p\",[e._v(\"When the build finishes, push the container to Docker Hub.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"# Push to Docker Hub\")]),e._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"docker\")]),e._v(\" push \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[e._v(\"$DockerId\")]),e._v(\"/goof:dev\\n\")])])]),a(\"h2\",{attrs:{id:\"deploy-the-application-to-kubernetes\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#deploy-the-application-to-kubernetes\"}},[e._v(\"#\")]),e._v(\" Deploy the application to Kubernetes\")]),e._v(\" \"),a(\"p\",[e._v(\"To ensure the container deploys correctly into Kubernetes without incurring cloud costs, we use the Kubernetes cluster shipped with Docker Desktop. Before deploying the app, you'll need to make a change to the app's deployment manifest. Open the file \"),a(\"code\",[e._v(\"goof-deployment.yaml\")]),e._v(\" in a text editor.\")]),e._v(\" \"),a(\"p\",[e._v(\"Find these lines, and insert your Docker ID where indicated.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-yaml extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[e._v(\"spec\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\":\")]),e._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[e._v(\"containers\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\":\")]),e._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\"-\")]),e._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[e._v(\"image\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\":\")]),e._v(\" <<DOCKERID\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\">\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\">\")]),e._v(\"/goof\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\":\")]),e._v(\"dev \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"#Edit with your Docker Hub ID\")]),e._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[e._v(\"name\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\":\")]),e._v(\" goof\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[e._v(\"imagePullPolicy\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\":\")]),e._v(\" Always\\n\")])])]),a(\"p\",[e._v(\"Save your changes. Now you're ready to deploy the application. Run the following commands:\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"# Create a namespace\")]),e._v(\"\\nkubectl create ns snyk-docker\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"# Set the current context to use the new namespace\")]),e._v(\"\\nkubectl config set-context --current --namespace snyk-docker\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[e._v(\"# Spin up the goof deployment and service\")]),e._v(\"\\nkubectl create -f goof-deployment.yaml,goof-mongo-deployment.yaml\\n\")])])]),a(\"p\",[e._v(\"To check the status of the pods as the application comes up, use the following command:\")]),e._v(\" \"),a(\"div\",{staticClass:\"language-bash extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[e._v(\"kubectl get pods\\n\")])])]),a(\"p\",[e._v(\"Once both are running, the application should now be accessible in \"),a(\"a\",{attrs:{href:\"http://localhost:3001\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"http://localhost:3001\"),a(\"OutboundLink\")],1),e._v(\". Success!\")]),e._v(\" \"),a(\"p\",[e._v(\"Now that we know our application works when deployed into Kubernetes, we'll set up a continuous integration and continuous delivery pipeline to re-build our container as code changes are made.\")])])}),[],!1,null,null,null);t.default=n.exports}}]);","extractedComments":[]}
{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[894],{1292:function(e,t,s){\"use strict\";s.r(t);var r=s(56),a=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":e.$parent.slotKey}},[s(\"h1\",{attrs:{id:\"provision-azure-services\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#provision-azure-services\"}},[e._v(\"#\")]),e._v(\" Provision Azure services\")]),e._v(\" \"),s(\"h2\",{attrs:{id:\"background\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#background\"}},[e._v(\"#\")]),e._v(\" Background\")]),e._v(\" \"),s(\"p\",[e._v(\"In order to understand the various Snyk integration points to Azure, we are going to deploy and configure some supporting resources. The objective for these exercises is to demonstrate how Snyk secures your workloads. We will provide basic patterns intended for use in learning environments. For a deeper dive and learning more about Azure, we suggest referencing Microsoft's self-paced \"),s(\"a\",{attrs:{href:\"https://docs.microsoft.com/en-us/learn/browse/?products=azure\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"training modules\"),s(\"OutboundLink\")],1),e._v(\".\")]),e._v(\" \"),s(\"h2\",{attrs:{id:\"deploy-azure-kubernetes-service-aks\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#deploy-azure-kubernetes-service-aks\"}},[e._v(\"#\")]),e._v(\" Deploy Azure Kubernetes Service (AKS)\")]),e._v(\" \"),s(\"p\",[e._v(\"The following examples are based on an \"),s(\"a\",{attrs:{href:\"https://docs.microsoft.com/en-us/azure/aks/kubernetes-walkthrough\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Azure Quickstart\"),s(\"OutboundLink\")],1),e._v(\" for deploying AKS using the CLI. We will deploy a cluster as well as a sample multi-container application. The application will include both a web front end as well as a Redis instance.\")]),e._v(\" \"),s(\"h3\",{attrs:{id:\"create-a-resource-group\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#create-a-resource-group\"}},[e._v(\"#\")]),e._v(\" Create a resource group\")]),e._v(\" \"),s(\"p\",[e._v(\"We begin by creating an \"),s(\"a\",{attrs:{href:\"https://docs.microsoft.com/en-us/learn/modules/control-and-organize-with-azure-resource-manager/2-principles-of-resource-groups\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Azure resource group\"),s(\"OutboundLink\")],1),e._v(\" to logical organize the resources we will deploy and manage. Here, we will also define the location where our resources will run in Azure. In this case, we will deploy to the \"),s(\"code\",[e._v(\"eastus\")]),e._v(\" location. From your terminal, run the following command:\")]),e._v(\" \"),s(\"div\",{staticClass:\"language-bash extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[s(\"code\",[e._v(\"az group create --name mySnykAKSResourceGroup --location eastus\\n\")])])]),s(\"p\",[e._v(\"When successfully completed, you will see output similar to the following:\")]),e._v(\" \"),s(\"div\",{staticClass:\"language-javascript extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-javascript\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\"{\")]),e._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token string-property property\"}},[e._v('\"id\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\":\")]),e._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[e._v('\"/subscriptions/<guid>/resourceGroups/mySnykAKSResourceGroup\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\",\")]),e._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token string-property property\"}},[e._v('\"location\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\":\")]),e._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[e._v('\"eastus\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\",\")]),e._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token string-property property\"}},[e._v('\"managedBy\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\":\")]),e._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[e._v(\"null\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\",\")]),e._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token string-property property\"}},[e._v('\"name\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\":\")]),e._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[e._v('\"mySnykAKSResourceGroup\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\",\")]),e._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token string-property property\"}},[e._v('\"properties\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\":\")]),e._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\"{\")]),e._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token string-property property\"}},[e._v('\"provisioningState\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\":\")]),e._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[e._v('\"Succeeded\"')]),e._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\"}\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\",\")]),e._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token string-property property\"}},[e._v('\"tags\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\":\")]),e._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[e._v(\"null\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\",\")]),e._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token string-property property\"}},[e._v('\"type\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\":\")]),e._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[e._v('\"Microsoft.Resources/resourceGroups\"')]),e._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[e._v(\"}\")]),e._v(\"\\n\")])])]),s(\"p\",[e._v(\"You can also validate the creation of the resource group in the Azure portal as illustrate below:\")]),e._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://partner-workshop-assets.s3.us-east-2.amazonaws.com/azure_resource_groups_01.png\",alt:\"\"}})]),e._v(\" \"),s(\"h3\",{attrs:{id:\"create-the-aks-cluster\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#create-the-aks-cluster\"}},[e._v(\"#\")]),e._v(\" Create the AKS cluster\")]),e._v(\" \"),s(\"p\",[e._v(\"Next, we are going to create a cluster named \"),s(\"code\",[e._v(\"mySnykAKSCluster\")]),e._v(\" in our recently created \"),s(\"code\",[e._v(\"mySnykAKSResourceGroup\")]),e._v(\". Our cluster will have one node and will have monitoring enabled.\")]),e._v(\" \"),s(\"div\",{staticClass:\"language-bash extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[s(\"code\",[e._v(\"az aks create --resource-group mySnykAKSResourceGroup --name mySnykAKSCluster --node-count \"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[e._v(\"1\")]),e._v(\" --enable-addons monitoring --generate-ssh-keys\\n\")])])]),s(\"p\",[e._v(\"This may take several minutes to complete. You will see the following outputs in the terminal:\")]),e._v(\" \"),s(\"div\",{staticClass:\"language-text extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[e._v(\"Finished service principal creation[##########################]  100.0000%\\n- Running...\\nAAD role propagation done[[##########################]  100.0000%\\n\")])])]),s(\"p\",[e._v(\"Once the deployment completes the CLI will return a lengthy JSON response containing details about your cluster. You can also view this within the Azure portal:\")]),e._v(\" \"),s(\"p\",[s(\"em\",[s(\"strong\",[e._v(\"Figure 1\")])])]),e._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://partner-workshop-assets.s3.us-east-2.amazonaws.com/azure_resource_groups_02.png\",alt:\"\"}})]),e._v(\" \"),s(\"p\",[s(\"em\",[s(\"strong\",[e._v(\"Figure 2\")])])]),e._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://partner-workshop-assets.s3.us-east-2.amazonaws.com/azure_resource_groups_03.png\",alt:\"\"}})]),e._v(\" \"),s(\"p\",[s(\"em\",[s(\"strong\",[e._v(\"Figure 3\")])])]),e._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://partner-workshop-assets.s3.us-east-2.amazonaws.com/azure_resource_groups_04.png\",alt:\"\"}})]),e._v(\" \"),s(\"h3\",{attrs:{id:\"connect-to-the-cluster\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#connect-to-the-cluster\"}},[e._v(\"#\")]),e._v(\" Connect to the cluster\")]),e._v(\" \"),s(\"p\",[e._v(\"To manage our AKS cluster, we will use \"),s(\"a\",{attrs:{href:\"https://kubernetes.io/docs/user-guide/kubectl/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"kubectl\"),s(\"OutboundLink\")],1),e._v(\". Since we are using the Azure CLI, we will need to install \"),s(\"code\",[e._v(\"kubectl\")]),e._v(\" with the following command:\")]),e._v(\" \"),s(\"div\",{staticClass:\"language-bash extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[s(\"code\",[e._v(\"az aks install-cli\\n\")])])]),s(\"p\",[e._v(\"Next, we will need to configure \"),s(\"code\",[e._v(\"kubectl\")]),e._v(\" to connect to AKS by downloading our credentials and configuring the CLI to use these.\")]),e._v(\" \"),s(\"div\",{staticClass:\"language-bash extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[s(\"code\",[e._v(\"az aks get-credentials --resource-group mySnykAKSResourceGroup --name mySnykAKSCluster\\n\")])])]),s(\"p\",[e._v(\"If successful, you should see output similar to this:\")]),e._v(\" \"),s(\"div\",{staticClass:\"language-text extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[e._v('Merged \"mySnykAKSCluster\" as current context in $HOME/.kube/config\\n')])])]),s(\"p\",[e._v(\"Now, we are ready to verify our connection to our cluster.\")]),e._v(\" \"),s(\"div\",{staticClass:\"language-bash extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[s(\"code\",[e._v(\"kubectl get nodes\\n\")])])]),s(\"p\",[e._v(\"When the node is ready, you should see an example output similar to the following:\")]),e._v(\" \"),s(\"div\",{staticClass:\"language-text extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[e._v(\"NAME                                STATUS   ROLES   AGE   VERSION\\naks-nodepool1-27048785-vmss000000   Ready    agent   5m    v1.15.10\\n\")])])])])}),[],!1,null,null,null);t.default=a.exports}}]);","extractedComments":[]}
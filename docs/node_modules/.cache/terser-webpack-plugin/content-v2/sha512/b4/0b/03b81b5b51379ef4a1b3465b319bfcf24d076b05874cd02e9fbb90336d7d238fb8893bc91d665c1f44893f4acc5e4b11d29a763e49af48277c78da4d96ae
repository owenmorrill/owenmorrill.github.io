{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[609],{1004:function(e,n,a){\"use strict\";a.r(n);var t=a(56),r=Object(t.a)({},(function(){var e=this,n=e.$createElement,a=e._self._c||n;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":e.$parent.slotKey}},[a(\"h1\",{attrs:{id:\"snyk-for-bazel\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#snyk-for-bazel\"}},[e._v(\"#\")]),e._v(\" Snyk for Bazel\")]),e._v(\" \"),a(\"p\",[e._v(\"Snyk supports testing projects that have their dependencies managed by Bazel.\")]),e._v(\" \"),a(\"p\",[e._v(\"Support is available via the \"),a(\"a\",{attrs:{href:\"https://raw.githubusercontent.com/snyk/user-docs/main/docs/../features/snyk-api-info/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Snyk API\"),a(\"OutboundLink\")],1),e._v(\".\")]),e._v(\" \"),a(\"p\",[e._v('{% hint style=\"info\" %}\\n'),a(\"strong\",[e._v(\"Feature availability\")]),a(\"br\"),e._v(\"\\nThe Snyk API is available with Business and Enterprise plans. See \"),a(\"a\",{attrs:{href:\"https://snyk.io/plans/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"pricing plans\"),a(\"OutboundLink\")],1),e._v(\" for more details.\\n{% endhint %}\")]),e._v(\" \"),a(\"p\",[e._v('{% hint style=\"info\" %}\\nThe Dep Graph API requires additional permissions. Please '),a(\"a\",{attrs:{href:\"https://support.snyk.io/hc/en-us/requests/new\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"contact our Support team\"),a(\"OutboundLink\")],1),e._v(\" to request access.\\n{% endhint %}\")]),e._v(\" \"),a(\"p\",[e._v(\"The following describes how to use Snyk to test your Bazel projects.\")]),e._v(\" \"),a(\"h3\",{attrs:{id:\"bazel-overview\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#bazel-overview\"}},[e._v(\"#\")]),e._v(\" Bazel Overview\")]),e._v(\" \"),a(\"p\",[e._v(\"According to \"),a(\"a\",{attrs:{href:\"https://docs.bazel.build/versions/master/bazel-overview.html\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"https://docs.bazel.build/versions/master/bazel-overview.html\"),a(\"OutboundLink\")],1)]),e._v(\" \"),a(\"blockquote\",[a(\"p\",[a(\"em\",[e._v(\"Bazel is an open-source build and test tool similar to Make, Maven, and Gradle. It uses a human-readable, high-level build language. Bazel supports projects in multiple languages and builds outputs for multiple platforms. Bazel supports large codebases across multiple repositories, and large numbers of users\")])])]),e._v(\" \"),a(\"p\",[e._v(\"Bazel does not have dependency manifest files or lock files that package managers such as npm have. Instead, build configuration is managed in \"),a(\"a\",{attrs:{href:\"https://docs.bazel.build/versions/master/build-ref.html#BUILD_files\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"BUILD\"),a(\"OutboundLink\")],1),e._v(\" files, using \"),a(\"a\",{attrs:{href:\"https://docs.bazel.build/versions/master/skylark/language.html\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Starlark\"),a(\"OutboundLink\")],1),e._v(\", a domain specific language based on Python3.\")]),e._v(\" \"),a(\"p\",[e._v(\"Bazel has limited native integration with package registries such as npmjs.org or Maven Central. There are some Bazel rules that can be added to help with installing dependencies from external registries, e.g. \"),a(\"a\",{attrs:{href:\"https://docs.bazel.build/versions/master/external.html#maven-artifacts-and-repositories\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"from Maven\"),a(\"OutboundLink\")],1),e._v(\".\")]),e._v(\" \"),a(\"p\",[e._v(\"However, in many cases users must manually specify their dependency information (package name, location & version), including all transitives. These can then be fetched by Bazel during builds.\")]),e._v(\" \"),a(\"p\",[e._v(\"Because Bazel dependencies are specified as code in BUILD files using Starlark, Snyk cannot easily discover which dependencies a project has.\")]),e._v(\" \"),a(\"p\",[e._v(\"The recommended approach is to test your dependencies via the \"),a(\"a\",{attrs:{href:\"https://github.com/snyk/dep-graph\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Snyk Dep Graph Test API\"),a(\"OutboundLink\")],1),e._v(\".\")]),e._v(\" \"),a(\"h3\",{attrs:{id:\"how-it-works\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#how-it-works\"}},[e._v(\"#\")]),e._v(\" How it works\")]),e._v(\" \"),a(\"ol\",[a(\"li\",[a(\"p\",[e._v(\"For each type of dependency (e.g. Maven, Cocoapods), create a \"),a(\"a\",{attrs:{href:\"https://github.com/snyk/dep-graph\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Dep Graph JSON object\"),a(\"OutboundLink\")],1),e._v(\" listing all the dependency packages and versions (see below)\")])]),e._v(\" \"),a(\"li\",[a(\"p\",[e._v(\"As part of a Bazel test rule, send this object as a POST request to the \"),a(\"a\",{attrs:{href:\"https://github.com/snyk/dep-graph\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Dep Graph Test API\"),a(\"OutboundLink\")],1),e._v(\", (along with your \"),a(\"a\",{attrs:{href:\"https://docs.snyk.io/snyk-api-info/authentication-for-api\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"auth token\"),a(\"OutboundLink\")],1),e._v(\"), example curl request:\")]),e._v(\" \"),a(\"div\",{staticClass:\"language- extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[e._v(\"curl -X POST 'https://snyk.io/api/v1/test/dep-graph' \\\\\\n  -H 'Authorization: token {{your token}}' \\\\\\n  -H 'Content-Type: application/json; charset=utf-8' \\\\\\n  -d @dep-graph.json\\n\")])])])]),e._v(\" \"),a(\"li\",[a(\"p\",[e._v(\"Check the \"),a(\"a\",{attrs:{href:\"https://support.snyk.io/hc/en-us/articles/360011549737-Snyk-for-Bazel#h_01EEWP8F4MK9MFJT5X0A4ZGS93\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"API response\"),a(\"OutboundLink\")],1),e._v(\" for pass/fail status and any resulting vulnerabilities\")])])]),e._v(\" \"),a(\"h3\",{attrs:{id:\"snyk-dep-graph-test-api\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#snyk-dep-graph-test-api\"}},[e._v(\"#\")]),e._v(\" Snyk Dep Graph Test API\")]),e._v(\" \"),a(\"p\",[e._v(\"The Snyk Dep Graph Test API takes a generic dependency graph, and returns a report containing any relevant vulnerabilities for those dependencies.\")]),e._v(\" \"),a(\"p\",[e._v(\"The set of supported package managers/repository ecosystems are listed on the \"),a(\"a\",{attrs:{href:\"https://snyk.docs.apiary.io/#reference/test/dep-graph/test-dep-graph\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"API documentation\"),a(\"OutboundLink\")],1),e._v(\" (at time of writing these are \"),a(\"code\",[e._v(\"deb\")]),e._v(\", \"),a(\"code\",[e._v(\"gomodules\")]),e._v(\", \"),a(\"code\",[e._v(\"gradle\")]),e._v(\", \"),a(\"code\",[e._v(\"maven\")]),e._v(\", \"),a(\"code\",[e._v(\"npm\")]),e._v(\", \"),a(\"code\",[e._v(\"nuget\")]),e._v(\", \"),a(\"code\",[e._v(\"paket\")]),e._v(\", \"),a(\"code\",[e._v(\"pip\")]),e._v(\", \"),a(\"code\",[e._v(\"rpm\")]),e._v(\", \"),a(\"code\",[e._v(\"rubygems\")]),e._v(\" & \"),a(\"code\",[e._v(\"cocoapods\")]),e._v(\").\")]),e._v(\" \"),a(\"p\",[e._v(\"Any of your Bazel dependencies that are available in these ecosystems can be tested via the API.\")]),e._v(\" \"),a(\"h3\",{attrs:{id:\"snyk-dep-graph-json-syntax\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#snyk-dep-graph-json-syntax\"}},[e._v(\"#\")]),e._v(\" Snyk Dep Graph JSON Syntax\")]),e._v(\" \"),a(\"p\",[e._v(\"The Dep Graph Test API takes a \"),a(\"a\",{attrs:{href:\"https://github.com/snyk/dep-graph\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Snyk Dep Graph\"),a(\"OutboundLink\")],1),e._v(\" JSON object describing the root application, and the graph of direct and transitive dependencies.\")]),e._v(\" \"),a(\"p\",[e._v(\"The \"),a(\"a\",{attrs:{href:\"https://github.com/snyk/dep-graph#depgraphdata\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"schema\"),a(\"OutboundLink\")],1),e._v(\" for this format is as follows:\")]),e._v(\" \"),a(\"div\",{staticClass:\"language- extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[e._v(\"export interface DepGraphData {\\n  schemaVersion: string;\\n  pkgManager: {\\n    name: string;\\n    version?: string;\\n    repositories?: Array<{\\n      alias: string;\\n    }>;\\n  };\\n  pkgs: Array<{\\n    id: string;\\n    info: {\\n      name: string;\\n      version?: string;\\n    };\\n  }>;\\n  graph: {\\n    rootNodeId: string;\\n    nodes: Array<{\\n      nodeId: string;\\n      pkgId: string;\\n      info?: {\\n        versionProvenance?: {\\n          type: string;\\n          location: string;\\n          property?: {\\n            name: string;\\n          };\\n        },\\n        labels?: {\\n          [key: string]: string | undefined;\\n        };\\n      };\\n      deps: Array<{\\n        nodeId: string;\\n      }>;\\n    }>;\\n  };\\n}\\n\")])])]),a(\"p\",[e._v(\"Here are some further notes on specific components in the dep graph object:\")]),e._v(\" \"),a(\"ul\",[a(\"li\",[a(\"code\",[e._v(\"schemaVersion\")]),e._v(\" - version of the dep-graph schema, set this to \"),a(\"code\",[e._v(\"1.2.0\")])]),e._v(\" \"),a(\"li\",[a(\"code\",[e._v(\"pkgManager.name\")]),e._v(\" - one of \"),a(\"code\",[e._v(\"deb\")]),e._v(\", \"),a(\"code\",[e._v(\"gomodules\")]),e._v(\", \"),a(\"code\",[e._v(\"gradle\")]),e._v(\", \"),a(\"code\",[e._v(\"maven\")]),e._v(\", \"),a(\"code\",[e._v(\"npm\")]),e._v(\", \"),a(\"code\",[e._v(\"nuget\")]),e._v(\", \"),a(\"code\",[e._v(\"paket\")]),e._v(\", \"),a(\"code\",[e._v(\"pip\")]),e._v(\", \"),a(\"code\",[e._v(\"rpm\")]),e._v(\", \"),a(\"code\",[e._v(\"rubygems\")]),e._v(\" or \"),a(\"code\",[e._v(\"cocoapods\")])]),e._v(\" \"),a(\"li\",[a(\"code\",[e._v(\"pkgs\")]),e._v(\" - array of objects containing \"),a(\"code\",[e._v(\"id\")]),e._v(\", \"),a(\"code\",[e._v(\"name\")]),e._v(\" & \"),a(\"code\",[e._v(\"version\")]),e._v(\" of all packages in the dep-graph. Note that the \"),a(\"code\",[e._v(\"id\")]),e._v(\" \"),a(\"em\",[e._v(\"must\")]),e._v(\" be of the form \"),a(\"code\",[e._v(\"name@version\")]),e._v(\". List each of your dependencies in this array, including an item representing the project itself\")]),e._v(\" \"),a(\"li\",[a(\"code\",[e._v(\"graph.nodes\")]),e._v(\" - array of objects describing the relationships between entries in \"),a(\"code\",[e._v(\"pkgs\")]),e._v(\". In Bazel this is typically just the project node with all other packages defined as a flat array of direct dependencies in \"),a(\"code\",[e._v(\"deps\")])]),e._v(\" \"),a(\"li\",[a(\"code\",[e._v(\"graph.rootNodeId\")]),e._v(\" - specifies the \"),a(\"code\",[e._v(\"id\")]),e._v(\" of the entry in \"),a(\"code\",[e._v(\"graph.nodes\")]),e._v(\" to use as the root node of the graph. You should set this to the \"),a(\"code\",[e._v(\"nodeId\")]),e._v(\" of the project node\")])]),e._v(\" \"),a(\"h3\",{attrs:{id:\"snyk-dep-graph-test-api-response\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#snyk-dep-graph-test-api-response\"}},[e._v(\"#\")]),e._v(\" Snyk Dep Graph Test API Response\")]),e._v(\" \"),a(\"p\",[e._v(\"The Dep Graph Test API returns a JSON object describing any issues (vulnerabilities & licences) found in the dep graph dependencies.\")]),e._v(\" \"),a(\"p\",[e._v(\"Here is an example response with a single vulnerability.\")]),e._v(\" \"),a(\"div\",{staticClass:\"language- extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[e._v('{\\n    \"ok\": false,\\n    \"packageManager\": \"maven\",\\n    \"issuesData\": {\\n        \"SNYK-JAVA-CHQOSLOGBACK-30208\": {\\n            \"CVSSv3\": \"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H\",\\n            \"alternativeIds\": [],\\n            \"creationTime\": \"2017-03-19T14:58:38Z\",\\n            \"credit\": [\\n                \"Unknown\"\\n            ],\\n            \"cvssScore\": 9.8,\\n            \"description\": \"## Overview\\\\n[ch.qos.logback:logback-core](https://mvnrepository.com/artifact/ch.qos.logback/logback-core) is a logback-core module.\\\\n\\\\nAffected versions of this package are vulnerable to Arbitrary Code Execution. A configuration can be ...\",\\n            \"disclosureTime\": \"2017-03-13T06:59:00Z\",\\n            \"exploit\": \"Not Defined\",\\n            \"fixedIn\": [\\n                \"1.1.11\"\\n            ],\\n            \"functions\": [],\\n            \"id\": \"SNYK-JAVA-CHQOSLOGBACK-30208\",\\n            \"identifiers\": {\\n                \"CVE\": [\\n                    \"CVE-2017-5929\"\\n                ],\\n                \"CWE\": [\\n                    \"CWE-502\"\\n                ]\\n            },\\n            \"language\": \"java\",\\n            \"mavenModuleName\": {\\n                \"artifactId\": \"logback-core\",\\n                \"groupId\": \"ch.qos.logback\"\\n            },\\n            \"modificationTime\": \"2020-06-12T14:36:56.271247Z\",\\n            \"moduleName\": \"ch.qos.logback:logback-core\",\\n            \"packageManager\": \"maven\",\\n            \"packageName\": \"ch.qos.logback:logback-core\",\\n            \"patches\": [],\\n            \"proprietary\": false,\\n            \"publicationTime\": \"2017-03-21T15:30:44Z\",\\n            \"references\": [\\n                {\\n                    \"title\": \"GitHub Commit #1\",\\n                    \"url\": \"https://github.com/qos-ch/logback/commit/f46044b805bca91efe5fd6afe52257cd02f775f8\"\\n                },\\n                {\\n                    \"title\": \"GitHub Commit #2\",\\n                    \"url\": \"https://github.com/qos-ch/logback/commit/979b042cb1f0b4c1e5869ccc8912e68c39f769f9\"\\n                },\\n                {\\n                    \"title\": \"Logback News\",\\n                    \"url\": \"https://logback.qos.ch/news.html\"\\n                },\\n                {\\n                    \"title\": \"NVD\",\\n                    \"url\": \"https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-5929\"\\n                },\\n                {\\n                    \"title\": \"NVD\",\\n                    \"url\": \"https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-5929/\"\\n                }\\n            ],\\n            \"semver\": {\\n                \"vulnerable\": [\\n                    \"[, 1.1.11)\"\\n                ]\\n            },\\n            \"severity\": \"high\",\\n            \"title\": \"Arbitrary Code Execution\"\\n        }\\n    },\\n    \"issues\": [\\n        {\\n            \"pkgName\": \"ch.qos.logback:logback-core\",\\n            \"pkgVersion\": \"1.0.13\",\\n            \"issueId\": \"SNYK-JAVA-CHQOSLOGBACK-30208\",\\n            \"fixInfo\": {}\\n        }\\n    ],\\n    \"org\": {\\n        \"id\": \"3e5fe3fe-9181-4f0f-a231-39764485e73f\",\\n        \"name\": \"stephen.elson-xnf\"\\n    }\\n}\\n')])])]),a(\"p\",[e._v(\"Here are some further notes on specific components in the response object:\")]),e._v(\" \"),a(\"ul\",[a(\"li\",[a(\"code\",[e._v(\"ok\")]),e._v(\" - boolean value summarising whether Snyk found any vulnerabilities in the supplied dependencies. You can use this for a quick pass/fail test\")]),e._v(\" \"),a(\"li\",[a(\"code\",[e._v(\"issuesData\")]),e._v(\" - a hash of each unique vulnerability found. Each vulnerability contains many useful properties, such as \"),a(\"code\",[e._v(\"title\")]),e._v(\", \"),a(\"code\",[e._v(\"description\")]),e._v(\", \"),a(\"code\",[e._v(\"identifiers\")]),e._v(\", \"),a(\"code\",[e._v(\"publicationTime\")]),e._v(\", \"),a(\"code\",[e._v(\"severity\")]),e._v(\" etc\")]),e._v(\" \"),a(\"li\",[a(\"code\",[e._v(\"issues\")]),e._v(\" - an simple array of mappings from vulnerabilities in \"),a(\"code\",[e._v(\"issuesData\")]),e._v(\" to package. As a vulnerability may be relevant to multiple packages, this mapping is used to keep the response length as short as possible\")])]),e._v(\" \"),a(\"h3\",{attrs:{id:\"examples\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#examples\"}},[e._v(\"#\")]),e._v(\" Examples\")]),e._v(\" \"),a(\"p\",[e._v('{% hint style=\"info\" %}\\n'),a(\"strong\",[e._v(\"Note\")]),a(\"br\"),e._v(\"\\nSee \"),a(\"a\",{attrs:{href:\"https://github.com/snyk/bazel-simple-app\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"https://github.com/snyk/bazel-simple-app\"),a(\"OutboundLink\")],1),e._v(\" for a full example Bazel Java project, and corresponding Snyk Dep Graph object.\\n{% endhint %}\")]),e._v(\" \"),a(\"p\",[e._v(\"For a simple Bazel project with a single dependency on a Maven package, you may specify the dependency like this:\")]),e._v(\" \"),a(\"div\",{staticClass:\"language- extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[e._v('maven_jar(\\n    name = \"logback-core\",\\n    artifact = \"ch.qos.logback:logback-core:1.0.13\",\\n    sha1 = \"dc6e6ce937347bd4d990fc89f4ceb469db53e45e\",\\n)\\n')])])]),a(\"p\",[e._v(\"From this you could construct the following Dep Graph JSON object:\")]),e._v(\" \"),a(\"div\",{staticClass:\"language- extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[e._v('{\\n  \"depGraph\": {\\n    \"schemaVersion\": \"1.2.0\",\\n    \"pkgManager\": {\\n      \"name\": \"maven\"\\n    },\\n    \"pkgs\": [\\n      {\\n        \"id\": \"app@1.0.0\",\\n        \"info\": {\\n          \"name\": \"app\",\\n          \"version\": \"1.0.0\"\\n        }\\n      },\\n      {\\n        \"id\": \"ch.qos.logback:logback-core@1.0.13\",\\n        \"info\": {\\n          \"name\": \"ch.qos.logback:logback-core\",\\n          \"version\": \"1.0.13\"\\n        }\\n      }\\n    ],\\n    \"graph\": {\\n      \"rootNodeId\": \"root-node\",\\n      \"nodes\": [\\n        {\\n          \"nodeId\": \"root-node\",\\n          \"pkgId\": \"app@1.0.0\",\\n          \"deps\": [\\n            {\\n              \"nodeId\": \"ch.qos.logback:logback-core@1.0.13\"\\n            }\\n          ]\\n        },\\n        {\\n          \"nodeId\": \"ch.qos.logback:logback-core@1.0.13\",\\n          \"pkgId\": \"ch.qos.logback:logback-core@1.0.13\",\\n          \"deps\": []\\n        }\\n      ]\\n    }\\n  }\\n}\\n')])])]),a(\"p\",[e._v(\"This particular package (\"),a(\"code\",[e._v(\"ch.qos.logback:logback-core@1.0.13\")]),e._v(\") contains a vulnerability, described in detail in the resulting JSON response object.\")])])}),[],!1,null,null,null);n.default=r.exports}}]);","extractedComments":[]}